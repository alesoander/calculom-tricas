<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lisis de Reservas - Calculom-tricas</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä An√°lisis de Reservas</h1>
            <p class="subtitle">Sistema de an√°lisis y m√©tricas de reservas por instancia</p>
        </header>

        <section class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">üìÑ</div>
                <h3>Cargar Archivo Excel</h3>
                <p>Arrastra y suelta tu archivo aqu√≠ o haz clic para seleccionar</p>
                <input type="file" id="fileInput" accept=".xlsx,.xls" hidden>
                <button class="btn-primary" onclick="document.getElementById('fileInput').click()">
                    Seleccionar Archivo
                </button>
            </div>
            <div id="fileName" class="file-name"></div>
        </section>

        <div id="errorMessage" class="error-message hidden"></div>
        <div id="loadingSpinner" class="loading-spinner hidden">
            <div class="spinner"></div>
            <p>Procesando archivo...</p>
        </div>

        <section id="resultsSection" class="results-section hidden">
            <!-- Export PDF Button -->
            <div class="export-section">
                <button id="exportPdfBtn" class="btn-export" onclick="exportToPDF()">
                    <span class="btn-icon">üìÑ</span>
                    <span class="btn-text">Exportar PDF</span>
                </button>
            </div>

            <!-- Overall Summary -->
            <div class="summary-card">
                <h2>üìà Resumen General</h2>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span class="summary-label">Total Reservas:</span>
                        <span class="summary-value" id="totalReservations">0</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Reservas Confirmadas:</span>
                        <span class="summary-value confirmed" id="totalConfirmed">0</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Reservas Pendientes:</span>
                        <span class="summary-value pending" id="totalPending">0</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Reservas Fallidas:</span>
                        <span class="summary-value failed" id="totalFailed">0</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Reservas Procesando:</span>
                        <span class="summary-value processing" id="totalProcessing">0</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Total Instancias:</span>
                        <span class="summary-value" id="totalInstances">0</span>
                    </div>
                </div>
            </div>

            <!-- Top 5 Instances -->
            <div class="chart-card">
                <h2>üèÜ Top 5 Instancias con M√°s Ventas</h2>
                <canvas id="top5Chart"></canvas>
                <div id="top5Table" class="top5-table"></div>
            </div>

            <!-- Global Conversion Rates -->
            <div class="conversion-card">
                <h2>üìä Tasas de Conversi√≥n Globales</h2>
                <div class="conversion-grid">
                    <div class="conversion-item">
                        <label for="totalQuotes">Total de Cotizaciones:</label>
                        <input type="number" id="totalQuotes" class="quote-input" min="0" value="0">
                    </div>
                    <div class="conversion-item">
                        <span class="conversion-label">Total Cotizaciones / Total Confirmadas:</span>
                        <span class="conversion-value" id="globalConversionRate">0.00%</span>
                    </div>
                </div>
            </div>

            <!-- Instance Details -->
            <div class="instances-section">
                <h2>üè¢ Detalles por Instancia</h2>
                <div id="instancesContainer"></div>
            </div>
        </section>
    </div>

    <script src="script.js"></script>
</body>
</html>